<div class="activities-container">
  <h1 class="title">Mes Activités</h1>

  <!-- Top controls -->
  <div class="top-controls">
    <input type="text" placeholder="Rechercher une activité..." [(ngModel)]="searchText" />
    <button (click)="clearFilters()">Annuler</button>
    <button class="add-btn" (click)="openModal($event)">+ Nouvelle activité</button>
  </div>

  <!-- Filtres -->
  <div class="filters">
    <select [(ngModel)]="filterStatus">
      <option value="">Tous les statuts</option>
      <option value="ACTIVE">Active</option>
      <option value="PENDING">Pending</option>
      <option value="CANCELLED">Cancelled</option>
    </select>

    <select [(ngModel)]="filterType">
      <option value="">Tous les types</option>
      <option value="Yoga">Yoga</option>
      <option value="Workshop">Workshop</option>
      <option value="Running">Running</option>
      <option value="Lecture">Lecture</option>
    </select>

    <select [(ngModel)]="filterLocation">
      <option value="">Toutes les localisations</option>
      <option value="Parc">Parc</option>
      <option value="Salle">Salle</option>
      <option value="Maison">Maison</option>
    </select>
  </div>

  <!-- Liste activités -->
  <div class="activities-list">
    <div class="activity-card" *ngFor="let activity of activities" (click)="viewDetails(activity.id)">
      <div class="activity-header">
        <h2>{{ activity.title }}</h2>
        <span class="activity-date">{{ activity.created_at | date:'dd/MM/yyyy' }}</span>
      </div>
    </div>
  </div>

  <!-- Modal -->
  <div class="modal-backdrop" *ngIf="showModal" (click)="closeModal()">
    <div class="modal" (click)="$event.stopPropagation()">
      <h2>Faites découvrir votre activité</h2>

      <div *ngIf="message" class="message" [ngClass]="messageType">{{ message }}</div>

      <form [formGroup]="activityForm" (ngSubmit)="submitActivity()">
        <label>Titre</label>
        <input formControlName="title" type="text" maxlength="100"/>
        <p class="char-counter" [class.warning]="activityForm.controls['title'].value?.length >= 100">
          {{ activityForm.controls['title'].value?.length || 0 }}/100
        </p>

        <label>Notes</label>
        <textarea formControlName="notes" rows="3" maxlength="400"></textarea>
        <p class="char-counter" [class.warning]="activityForm.controls['notes'].value?.length >= 400">
          {{ activityForm.controls['notes'].value?.length || 0 }}/400
        </p>

        <label>Date prévue</label>
        <input type="datetime-local" formControlName="plannedDate" [min]="minDateTime" />

        <label>Lieu</label>
        <input formControlName="location" type="text" />

        <label>Type</label>
        <select formControlName="type">
          <option value="Yoga">Yoga</option>
          <option value="Workshop">Workshop</option>
          <option value="Running">Running</option>
          <option value="Lecture">Lecture</option>
        </select>

        <label class="checkbox-label">
          <input type="checkbox" formControlName="isPrivate" />
          Privé
        </label>

        <label>Nombre max participants</label>
        <input type="number" formControlName="maxParticipants" min="2" max="100" />

        <div class="modal-buttons">
          <button type="button" (click)="closeModal()">Annuler</button>
          <button type="submit" [disabled]="activityForm.invalid">Créer</button>
        </div>
      </form>
    </div>
  </div>
</div>
